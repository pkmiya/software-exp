                         4 .list
                         5 ** EECS-Exp II/III software-exp-I
                         6 ** v1.0 / 2023-11-15
                         7 
                         8 ** INDEX
                         9 ** STEP 1: åˆæœŸåŒ–ãƒ«ãƒ¼ãƒãƒ³
                        10 ** STEP 4-2: INTERUT INTERFACE
                        11 ** STEP 6-3: INTERGET INTERFACE
                        12 ** STEP 0-1: ã‚­ãƒ¥ãƒ¼ã®åˆæœŸåŒ–ãƒ«ãƒ¼ãƒãƒ³(1/2)
                        13 ** STEP 0-2: ã‚­ãƒ¥ãƒ¼ã¸ã®å…¥åŠ›(INQ), å‡ºåŠ›(OUTQ) ãƒ«ãƒ¼ãƒãƒ³ 
                        14 ** STEP 4-1: INTERPUT
                        15 ** STEP 5-1: PUTSTRING
                        16 ** STEP 6-1: GETSTRING
                        17 ** STEP 6-2: INTERGET
                        18 ** STEP 7: ã‚¿ã‚¤ãƒåˆ¶å¾¡éƒ¨
                        19 ** STEP 8: ã‚·ã‚¹ãƒ†ãƒ ã‚³ãƒ¼ãƒ«ã‚¤ãƒ³ã‚¿ãƒ•ã‚§ãƒ¼ã‚¹
                        20 ** STEP 0-1: ã‚­ãƒ¥ãƒ¼ã®åˆæœŸåŒ–ãƒ«ãƒ¼ãƒãƒ³(2/2)
                        21 
                        22 /* STEP 1: åˆæœŸåŒ–ãƒ«ãƒ¼ãƒãƒ³ã®ä½œæˆ */
                        23 ***************************************************************
                        24 **å„ç¨®ãƒ¬ã‚¸ã‚¹ã‚¿å®šç¾©
                        25 ***************************************************************
                        26 ***************
                        27 **ãƒ¬ã‚¸ã‚¹ã‚¿ç¾¤ã®å…ˆé ­
                        28 ***************
                        29 .equ REGBASE,   0xFFF000          | DMAPã‚’ä½¿ç”¨ï¼
                        30 .equ IOBASE,    0x00d00000
                        31 ***************
                        32 **å‰²ã‚Šè¾¼ã¿é–¢ä¿‚ã®ãƒ¬ã‚¸ã‚¹ã‚¿
                        33 ***************
                        34 .equ IVR,       REGBASE+0x300     |å‰²ã‚Šè¾¼ã¿ãƒ™ã‚¯ã‚¿ãƒ¬ã‚¸ã‚¹ã‚¿
                        35 .equ IMR,       REGBASE+0x304     |å‰²ã‚Šè¾¼ã¿ãƒã‚¹ã‚¯ãƒ¬ã‚¸ã‚¹ã‚¿
                        36 .equ ISR,       REGBASE+0x30c     |å‰²ã‚Šè¾¼ã¿ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ¬ã‚¸ã‚¹ã‚¿
                        37 .equ IPR,       REGBASE+0x310     |å‰²ã‚Šè¾¼ã¿ãƒšãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒ¬ã‚¸ã‚¹ã‚¿
                        38 ***************
                        39 **ã‚¿ã‚¤ãƒé–¢ä¿‚ã®ãƒ¬ã‚¸ã‚¹ã‚¿
                        40 ***************
                        41 .equ TCTL1,     REGBASE+0x600     |ã‚¿ã‚¤ãƒï¼‘ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ¬ã‚¸ã‚¹ã‚¿
                        42 .equ TPRER1,    REGBASE+0x602     |ã‚¿ã‚¤ãƒï¼‘ãƒ—ãƒªã‚¹ã‚±ãƒ¼ãƒ©ãƒ¬ã‚¸ã‚¹ã‚¿
                        43 .equ TCMP1,     REGBASE+0x604     |ã‚¿ã‚¤ãƒï¼‘ã‚³ãƒ³ãƒšã‚¢ãƒ¬ã‚¸ã‚¹ã‚¿
                        44 .equ TCN1,      REGBASE+0x608     |ã‚¿ã‚¤ãƒï¼‘ã‚«ã‚¦ãƒ³ã‚¿ãƒ¬ã‚¸ã‚¹ã‚¿
                        45 .equ TSTAT1,    REGBASE+0x60a     |ã‚¿ã‚¤ãƒï¼‘ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ¬ã‚¸ã‚¹ã‚¿
                        46 ***************
                        47 ** UART1ï¼ˆé€å—ä¿¡ï¼‰é–¢ä¿‚ã®ãƒ¬ã‚¸ã‚¹ã‚¿
                        48 ***************
                        49 .equ USTCNT1,   REGBASE+0x900     | UART1ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹/ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ¬ã‚¸ã‚¹ã‚¿
                        50 .equ UBAUD1,    REGBASE+0x902     | UART1ãƒœãƒ¼ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ¬ã‚¸ã‚¹ã‚¿
                        51 .equ URX1,      REGBASE+0x904     | UART1å—ä¿¡ãƒ¬ã‚¸ã‚¹ã‚¿
                        52 .equ UTX1,      REGBASE+0x906     | UART1é€ä¿¡ãƒ¬ã‚¸ã‚¹ã‚¿
                        53 ***************
                        54 ** LED
                        55 ***************
                        56 .equ LED7,      IOBASE+0x000002f  |ãƒœãƒ¼ãƒ‰æ­è¼‰ã®LEDç”¨ãƒ¬ã‚¸ã‚¹ã‚¿
                        57 .equ LED6,      IOBASE+0x000002d  |ä½¿ç”¨æ³•ã«ã¤ã„ã¦ã¯ä»˜éŒ²A.4.3.1
                        58 .equ LED5,      IOBASE+0x000002b
                        59 .equ LED4,      IOBASE+0x0000029
                        60 .equ LED3,      IOBASE+0x000003f
                        61 .equ LED2,      IOBASE+0x000003d
                        62 .equ LED1,      IOBASE+0x000003b
                        63 .equ LED0,      IOBASE+0x0000039
                        64 
                        65 
                        66 ***************
                        67 **ã‚·ã‚¹ãƒ†ãƒ ã‚³ãƒ¼ãƒ«ç•ªå·
                        68 ***************
                        69 .equ SYSCALL_NUM_GETSTRING,     1
                        70 .equ SYSCALL_NUM_PUTSTRING,     2
                        71 .equ SYSCALL_NUM_RESET_TIMER,   3
                        72 .equ SYSCALL_NUM_SET_TIMER,     4
                        73 
                        74 
                        75 ***************************************************************
                        76 **ã‚¹ã‚¿ãƒƒã‚¯é ˜åŸŸã®ç¢ºä¿
                        77 ***************************************************************
                        78 .section .bss
                        79 .even
                        80 SYS_STK:
000e0c 0000 0000        81 	.ds.b   0x4000  |ã‚·ã‚¹ãƒ†ãƒ ã‚¹ã‚¿ãƒƒã‚¯é ˜åŸŸ
       0000 0000        81 
       0000 0000        81 
       0000 0000        81 
       0000 0000        81 
                        82 	.even
                        83 SYS_STK_TOP:        |ã‚·ã‚¹ãƒ†ãƒ ã‚¹ã‚¿ãƒƒã‚¯é ˜åŸŸã®æœ€å¾Œå°¾
                        84 task_p:
004e0c 0000 0000        85 	.ds.l 1         |ã‚¿ã‚¤ãƒç”¨
                        86 
                        87 ***************************************************************
                        88 **åˆæœŸåŒ–**å†…éƒ¨ãƒ‡ãƒã‚¤ã‚¹ãƒ¬ã‚¸ã‚¹ã‚¿ã«ã¯ç‰¹å®šã®å€¤ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ï¼
                        89 **ãã®ç†ç”±ã‚’çŸ¥ã‚‹ã«ã¯ï¼Œä»˜éŒ²Bã«ã‚ã‚‹å„ãƒ¬ã‚¸ã‚¹ã‚¿ã®ä»•æ§˜ã‚’å‚ç…§ã™ã‚‹ã“ã¨ï¼
                        90 ***************************************************************
                        91 .section .text
                        92 .even
                        93 boot:
                        94 	*ã‚¹ãƒ¼ãƒ‘ãƒ¼ãƒã‚¤ã‚¶&å„ç¨®è¨­å®šã‚’è¡Œã£ã¦ã„ã‚‹æœ€ä¸­ã®å‰²è¾¼ç¦æ­¢
000400 46FC 2700        95 	move.w #0x2700,%SR
000404 4FF9 0000        96 	lea.l  SYS_STK_TOP, %SP | Set SSP
       0000             96 
                        97 
                        98 
                        99 	****************
                       100 	**å‰²ã‚Šè¾¼ã¿ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã®åˆæœŸåŒ–
                       101 	****************
00040a 13FC 0040       102 	move.b #0x40, IVR       |ãƒ¦ãƒ¼ã‚¶å‰²ã‚Šè¾¼ã¿ãƒ™ã‚¯ã‚¿ç•ªå·ã‚’
       00FF F300       102 
                       103 				| 0x40+levelã«è¨­å®š.
000412 23FC 00FF       104 	move.l #0x00ffffff, IMR  |å…¨å‰²ã‚Šè¾¼ã¿ãƒã‚¹ã‚¯|**å‰²ã‚Šè¾¼ã¿ã‚’è¨±å¯
       FFFF 00FF       104 
       F304            104 
                       105 
                       106 	****************
                       107 	**é€å—ä¿¡(UART1)é–¢ä¿‚ã®åˆæœŸåŒ–(å‰²ã‚Šè¾¼ã¿ãƒ¬ãƒ™ãƒ«ã¯4ã«å›ºå®šã•ã‚Œã¦ã„ã‚‹)
                       108 	****************
00041c 33FC 0000       109 	move.w #0x0000, USTCNT1 |ãƒªã‚»ãƒƒãƒˆ
       00FF F900       109 
000424 33FC E10C       110 	move.w #0xE10C, USTCNT1 |é€å—ä¿¡å¯èƒ½,ãƒ‘ãƒªãƒ†ã‚£ãªã—, 1 stop, 8 bit,
       00FF F900       110 
                       111 				|é€å—ä¿¡å‰²ã‚Šè¾¼ã¿ç¦æ­¢
00042c 33FC 0038       112 	move.w #0x0038, UBAUD1  | baud rate = 230400 bps
       00FF F902       112 
                       113 
                       114 	****************
                       115 	**ã‚¿ã‚¤ãƒé–¢ä¿‚ã®åˆæœŸåŒ–(å‰²ã‚Šè¾¼ã¿ãƒ¬ãƒ™ãƒ«ã¯6ã«å›ºå®šã•ã‚Œã¦ã„ã‚‹)
                       116 	*****************
000434 33FC 0004       117 	move.w #0x0004, TCTL1   | restart,å‰²ã‚Šè¾¼ã¿ä¸å¯,|ã‚·ã‚¹ãƒ†ãƒ ã‚¯ãƒ­ãƒƒã‚¯ã®1/16ã‚’å˜ä½ã¨ã
       00FF F600       117 
                       118 	|ã‚¿ã‚¤ãƒä½¿ç”¨åœæ­¢
                       119 
                       120     *****************
                       121     ** ã‚­ãƒ¥ãƒ¼ã®åˆæœŸåŒ–
                       122     *****************
00043c 4EBA 02A0       123 	jsr INIT_Q
                       124 
                       125 	****************
                       126 	**å‰²ã‚Šè¾¼ã¿å‡¦ç†ãƒ«ãƒ¼ãƒãƒ³ã®åˆæœŸåŒ–
                       127 	****************
000440 21FC 0000       128 	move.l #INTERFACE, 0x110			/* level 4, (64+4)*4 */ 
       0000 0110       128 
000448 21FC 0000       129 	move.l #timer_interface, 0x118		/* level 6, (64+6)*4 */
       0000 0118       129 
000450 21FC 0000       130 	move.l #SYSCALL_INTERFACE, 0x080	/* trap #0 å‰²ã‚Šè¾¼ã¿ãƒ™ã‚¯ã‚¿è¨­å®š */
       0000 0080       130 
000458 23FC 00FF       131 	move.l #0x00ff3ff9, IMR				/* å‰²ã‚Šè¾¼ã¿è¨±å¯*/
       3FF9 00FF       131 
       F304            131 
000462 46FC 2000       132 	move.w #0x2000,%SR					/* èµ°è¡Œãƒ¬ãƒ™ãƒ«ã‚’0ã«ã™ã‚‹ */
                       133 
000466 6000 0002       134 	bra MAIN
                       135 
                       136 	
                       137 ****************************************************************
                       138 ***ãƒ—ãƒ­ã‚°ãƒ©ãƒ é ˜åŸŸ
                       139 ****************************************************************
                       140 .section .text
                       141 .even
                       142 MAIN:
                       143 	**èµ°è¡Œãƒ¢ãƒ¼ãƒ‰ã¨ãƒ¬ãƒ™ãƒ«ã®è¨­å®š(ã€Œãƒ¦ãƒ¼ã‚¶ãƒ¢ãƒ¼ãƒ‰ã€ã¸ã®ç§»è¡Œå‡¦ç†)
00046a 46FC 0000       144 	move.w #0x0000, %SR  | USER MODE, LEVEL 0
00046e 4FF9 0000       145 	lea.l USR_STK_TOP,%SP  | user stackã®è¨­å®š
       0000            145 
                       146 	/* MAIN INTERFACE */
                       147 
                       148 calculator:
                       149 	/* Init valiables */
000474 23FC 0000       150 	move.l	#0, ope1        /* 1st operand */
       0000 0000       150 
       0000            150 
00047e 13FC 0000       151 	move.b	#0, ope2        /* operator */
       0000 0000       151 
000486 23FC 0000       152 	move.l	#0, ope3        /* 2nd operand */
       0000 0000       152 
       0000            152 
000490 23FC 0000       153 	move.l	#0, ans_print   /* print buffer */
       0000 0000       153 
       0000            153 
00049a 23FC 0000       154 	move.l	#0, buf_len     /* input buffer length */
       0000 0000       154 
       0000            154 
                       155 
                       156     /* Process 1 */
0004a4 4EBA 0092       157 	jsr	get_expr
                       158 
0004a8 7002            159 	move.l #SYSCALL_NUM_PUTSTRING,%D0
0004aa 7200            160 	move.l #0, %d1          /* init %d1 for later */
0004ac 243C 0000       161     move.l #CRLF, %d2       /* display enter */
       0000            161 
0004b2 7602            162     move.l #2, %d3          /* size = 2 */
0004b4 4E40            163     trap #0                 /* syscall */
                       164 
                       165     /* Process 2-4 */
0004b6 4EBA 00D0       166 	jsr	token_div
0004ba 4EBA 0156       167 	jsr	calc
0004be 4EBA 01C2       168 	jsr	print
                       169 
0004c2 7002            170 	move.l #SYSCALL_NUM_PUTSTRING,%D0
0004c4 7200            171 	move.l #0, %d1          /* init %d1 for later */
0004c6 243C 0000       172     move.l #CRLF, %d2       /* display enter */
       0000            172 
0004cc 7602            173     move.l #2, %d3          /* size = 2 */
0004ce 4E40            174     trap #0                 /* syscall */
                       175 
                       176 
0004d0 6000 FFA2       177     bra	calculator
                       178 	
                       179 ******************************
                       180 * sys_GETSTRING, sys_PUTSTRINGã®ãƒ†ã‚¹ãƒˆ
                       181 *ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã®å…¥åŠ›ã‚’ã‚¨ã‚³ãƒ¼ãƒãƒƒã‚¯ã™ã‚‹
                       182 ******************************
                       183 LOOP:
0004d4 7001            184 	move.l #SYSCALL_NUM_GETSTRING, %D0
0004d6 7200            185 	move.l #0,   %D1        | ch    = 0
0004d8 243C 0000       186 	move.l #BUF, %D2        | p    = #BUF
       0000            186 
0004de 263C 0000       187 	move.l #256, %D3        | size = 256
       0100            187 
0004e4 4E40            188 	trap #0
0004e6 2600            189 	move.l %D0, %D3         | size = %D0 (length of given string)
0004e8 7002            190 	move.l #SYSCALL_NUM_PUTSTRING, %D0
0004ea 7200            191 	move.l #0,  %D1         | ch = 0
0004ec 243C 0000       192 	move.l #BUF,%D2         | p  = #BUF
       0000            192 
0004f2 4E40            193 	trap #0
0004f4 6000 FFDE       194 	bra LOOP
                       195 
                       196 
                       197 ****************************************************************
                       198 ***åˆæœŸå€¤ã®ã‚ã‚‹ãƒ‡ãƒ¼ã‚¿é ˜åŸŸ
                       199 ****************************************************************
                       200 .section .data
                       201 CRLF:
0009d4 0D0A            202 	.ascii  "\r\n"            | \r:è¡Œé ­ã¸(ã‚­ãƒ£ãƒªãƒƒã‚¸ãƒªã‚¿ãƒ¼ãƒ³)
                       203 	.even                     | \n:æ¬¡ã®è¡Œã¸(ãƒ©ã‚¤ãƒ³ãƒ•ã‚£ãƒ¼ãƒ‰)
                       204 
                       205 
                       206 ****************************************************************
                       207 ***åˆæœŸå€¤ã®ç„¡ã„ãƒ‡ãƒ¼ã‚¿é ˜åŸŸ
                       208 ****************************************************************
                       209 .section .bss
                       210 BUF:
004e10 0000 0000       211 	.ds.b 256           | BUF[256]
       0000 0000       211 
       0000 0000       211 
       0000 0000       211 
       0000 0000       211 
                       212 	.even
                       213 USR_STK:
004f10 0000 0000       214 	.ds.b 0x4000        |ãƒ¦ãƒ¼ã‚¶ã‚¹ã‚¿ãƒƒã‚¯é ˜åŸŸ
       0000 0000       214 
       0000 0000       214 
       0000 0000       214 
       0000 0000       214 
                       215 	.even
                       216 USR_STK_TOP:            |ãƒ¦ãƒ¼ã‚¶ã‚¹ã‚¿ãƒƒã‚¯é ˜åŸŸã®æœ€å¾Œå°¾
                       217 
                       218 
                       219 .section .text
                       220 .even
                       221 
                       222 /* STEP 4-2: INTERUT INTERFACE, STEP 6-3: INTERGET INTERFACE */
                       223 ** ã“ã“ã‹ã‚‰é€å—ä¿¡å‰²ã‚Šè¾¼ã¿ã‚¤ãƒ³ã‚¿ãƒ•ã‚§ãƒ¼ã‚¹
                       224 ** æ‹…å½“ï¼šé½Šè—¤
                       225 
                       226 ********************************
                       227 **é€å—ä¿¡å‰²ã‚Šè¾¼ã¿ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
                       228 ********************************ã€€
                       229 
                       230 ***************************************************************************************************
                       231 **ã€æ‰‹é †èª¬æ˜ã€‘
                       232 ** å—ä¿¡ãƒ¬ã‚¸ã‚¹ã‚¿ URX1 ã‚’ %D3.W ã«ã‚³ãƒ”ãƒ¼
                       233 ** %D3.W ã®ä¸‹ä½ 8bit(ãƒ‡ãƒ¼ã‚¿éƒ¨åˆ†) ã‚’ %D2.B ã«ã‚³ãƒ”ãƒ¼
                       234 ** ä»Šèµ·ã“ã£ã¦ã„ã‚‹å‰²ã‚Šè¾¼ã¿ãŒï¼Œå—ä¿¡å‰²ã‚Šè¾¼ã¿ã§ã‚ã‚‹ã‹ã‚’ï¼Œ%D3.W ã® ç¬¬ 13 ãƒ“ã
                       235 ** å—ä¿¡å‰²ã‚Šè¾¼ã¿ã§ã‚ã£ãŸå ´åˆï¼Œãƒãƒ£ãƒ³ãƒãƒ« ch = %D1.L =0, ãƒ‡ãƒ¼ã‚¿ data = %D2.B ã¨
                       236 ** ä»Šèµ·ã“ã£ã¦ã„ã‚‹ å‰²ã‚Šè¾¼ã¿ãŒï¼Œé€ä¿¡å‰²ã‚Šè¾¼ã¿ã§ã‚ã‚‹ã‹ã‚’ï¼Œé€ä¿¡ãƒ¬ã‚¸ã‚¹ã‚¿ U
                       237 ** é€ä¿¡å‰²ã‚Šè¾¼ã¿ã§ã‚ã£ãŸå ´åˆï¼Œch=%D1.L=0 ã¨ã—ã¦ INTERPUT ã‚’å‘¼ã³å‡ºã™
                       238 ***************************************************************************************************
                       239 
                       240 ***************************************************************************************************
                       241 **ã€å—ä¿¡ï¼†é€ä¿¡ãƒ¬ã‚¸ã‚¹ã‚¿ã®èª¬æ˜ã€‘
                       242 ** UTX1 15bit 0:é€ä¿¡FIFOãŒç©ºã§ãªã„ï¼ˆINTERPUTã§é€ä¿¡ã‚­ãƒ¥ãƒ¼ã‹ã‚‰OUTQï¼‰ 1:é€ä¿¡FIFOãŒ
                       243 ** URX1 13bit 0:å—ä¿¡FIFOãŒç©º              				 1:å—ä¿¡FIFOã«ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚‹ï¼ˆINTERGETã§å
                       244 ***************************************************************************************************
                       245 
                       246 INTERFACE:
0004f8 48E7 7080       247 	movem.l %d1-%d3/%a0, -(%sp)
                       248 INTERGET_INTERFACE:
0004fc 3639 00FF       249 	move.w  URX1, %d3	|URX1ã‚’d3ã«ã‚³ãƒ”ãƒ¼
       F904            249 
000502 1403            250 	move.b  %d3, %d2    |d3ã®ä¸‹ä½8bitã‚’ã‚³ãƒ”ãƒ¼ ã€€data = %d2.b
000504 0243 2000       251 	andi.w  #0x2000,%d3	|13ãƒ“ãƒƒãƒˆç›®ã‚’ãƒã‚§ãƒƒã‚¯ï¼ˆbit13=1ãªã‚‰%d3ãŒ0x2000ã¨ãªã‚‹ï¼‰
000508 0C43 2000       252 	cmpi.w  #0x2000,%d3	|%d3ãŒ0x2000ã§ã‚ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
00050c 6600 000C       253 	bne     INTERPUT_INTERFACE |13ãƒ“ãƒƒãƒˆç›®ãŒï¼‘ã ã£ãŸã‚‰å—ä¿¡å‰²è¾¼
000510 7200            254 	move.l  #0, %d1 	|å—ä¿¡å‰²ã‚Šè¾¼ã¿ã ã£ãŸã®ã§ã€ch=%d1.l=0ã¨ã—ã¦INTERGETã‚’å‘¼ã³å‡ºã™
000512 4EBA 03CE       255 	jsr     INTERGET        
000516 6000 001A       256 	bra	INTERFACE_FINISH
                       257 INTERPUT_INTERFACE:
00051a 3639 00FF       258 	move.w  UTX1, %d3
       F906            258 
000520 0243 8000       259 	andi.w  #0x8000, %d3
000524 0C43 0000       260 	cmpi.w  #0x0000, %d3 
000528 6700 0008       261 	beq    INTERFACE_FINISH |UTX1 15bit = 0ï¼ˆé€ä¿¡FIFOãŒç©ºã§ãªã„ï¼‰INTERPUT_FINISHã¸
00052c 7200            262 	move.l #0, %d1        	|é€ä¿¡å‰²ã‚Šè¾¼ã¿ã ã£ãŸã®ã§ã€ch=%d1.l=0ã¨ã—ã¦INTERPUTã‚’å‘¼ã³å‡
00052e 4EBA 02CC       263 	jsr    INTERPUT 
                       264 INTERFACE_FINISH:
000532 4CDF 010E       265 	movem.l (%sp)+, %d1-%d3/%a0
000536 4E73            266 	rte
                       267 
                       268 ** CALCULATOR MAIN PROGRAM | v1.0 2023-11-14
                       269 ** EXCEPT FOR INTERFACE; ALL FUNCTIONS ARE IMPLEMENTED IN MAIN SUBROUTINES
                       270 
                       271 /* STORE INPUT EXPRESSION IN BUFFER */
                       272 ** When character entered, store characters in buffer using GETSTRING and display characters using 
                       273 ** When Enter entered, go to next process
                       274 get_expr:
000538 48E7 F060       275     movem.l	%a1-%a2/%d0-%d3, -(%sp)     /* START: save registers */
00053c 43F9 0000       276     lea.l	buf, %a1                    /* get head address of buf */
       0000            276 
000542 45F9 0000       277     lea.l	buf, %a2
       0000            277 
000548 7200            278     move.l	#0, %d1
00054a 2409            279     move.l	%a1, %d2                    /* copy head address for later */
00054c 7601            280     move.l	#1, %d3
                       281 
                       282 get_expr_1_loop:
                       283     /* Syscall: get input */
00054e 7001            284 	move.l	#SYSCALL_NUM_GETSTRING, %d0
000550 7200            285 	move.l  #0, %d1
000552 7601            286 	move.l  #1, %d3
000554 4E40            287 	trap	#0
                       288 
                       289     /* Loop: wait until receive input */
000556 0C80 0000       290 	cmp.l	#0, %d0
       0000            290 
00055c 6700 FFF0       291 	beq	get_expr_1_loop 	 
                       292 
                       293     /* Loop: wait for expression end = Enter */
000560 2242            294 	move.l  %d2, %a1
000562 0C11 000D       295     cmp.b   #0x0d, (%a1)                /* see if the current character is Enter */
000566 6700 0012       296     beq     get_expr_2_end
                       297 
                       298     /* Syscall: put input */
00056a 7002            299 	move.l  #SYSCALL_NUM_PUTSTRING, %d0
00056c 7200            300 	move.l  #0, %d1
00056e 2409            301     move.l  %a1, %d2
000570 7601            302     move.l  #1, %d3
000572 4E40            303     trap    #0
                       304 
                       305     /* count exp length */
000574 5242            306 	add.w   #1, %d2
000576 6000 FFD6       307 	bra	get_expr_1_loop
                       308 
                       309 get_expr_2_end:
                       310     /* count and store exp length */
00057a 5242            311 	add.w   #1, %d2
00057c 23C2 0000       312 	move.l	%d2, buf_len
       0000            312 
000582 4CDF 060F       313 	movem.l	(%sp)+, %a1-%a2/%d0-%d3     /* END: restore registers */
000586 4E75            314 	rts
                       315 
                       316 
                       317 /* DEVIDE EXPRESSIONS INTO TOKENS */
                       318 ** Refer to the comments in each label
                       319 ** Operand: store operand value in %d0; calc and store operand by %d0 = %d0 * 10 + (input - '0')
                       320 ** Operator: store operator value in %d1
                       321 
                       322 /* Initialize registers */
                       323 token_div:
000588 48E7 E060       324 	movem.l %a1-%a2/%d0-%d2, -(%sp)
00058c 103C 0000       325 	move.b	#0, %d0                     /* ope1: 1st operand */
000590 123C 0000       326 	move.b	#0, %d1                     /* ope2: 2nd operand */
000594 143C 0000       327 	move.b	#0, %d2                     /* ope3: operator    */
000598 43F9 0000       328 	lea.l   buf, %a1                    /* init buffer */
       0000            328 
00059e 247C 0000       329 	movea.l	#buf_len, %a2
       0000            329 
                       330 
                       331 /* 1st operand analysis - DO THE SAME FOR 2ND OPERAND */
                       332 token_div_1_operand_1:
                       333     /* see if the current character is number (0-9) */
0005a4 0C11 0030       334 	cmp.b	#'0', (%a1)
0005a8 6500 0022       335 	bcs	token_div_2_operator
0005ac 0C11 0039       336 	cmp.b	#'9', (%a1)
0005b0 6200 001A       337 	bhi	token_div_2_operator
                       338 
                       339     /* true in the above condition; calc and store operand*/
0005b4 C0FC 000A       340 	mulu	#10, %d0
0005b8 0411 0030       341 	sub.b	#'0', (%a1)
0005bc D011            342 	add.b	(%a1), %d0
0005be D2FC 0001       343 	adda.w	#1, %a1
                       344 
                       345     /* see if the current position is the end of the expression */
0005c2 B3CA            346 	cmp.l	%a2, %a1
0005c4 6700 0034       347 	beq	token_div_4_end
0005c8 6000 FFDA       348 	bra	token_div_1_operand_1
                       349 
                       350 /* Operator analysis */
                       351 token_div_2_operator:
                       352     /* JUST store the operator and inc pointer*/
0005cc 1411            353 	move.b	(%a1), %d2
0005ce D2FC 0001       354 	adda.w  #1, %a1
                       355 
                       356 /* 2nd operand analysis - DO THE SAME FOR 1ST OPERAND */
                       357 token_div_3_operand_2:
                       358     /* see if the current character is number (0-9) */
0005d2 0C11 0030       359     cmp.b   #'0', (%a1)
0005d6 6500 0022       360     bcs  	token_div_4_end
0005da 0C11 0039       361     cmp.b   #'9', (%a1)
0005de 6200 001A       362     bhi     token_div_4_end
                       363 
                       364     /* true in the above condition; calc and store operand*/
0005e2 C2FC 000A       365     mulu    #10, %d1
0005e6 0411 0030       366 	sub.b   #'0', (%a1)
0005ea D211            367     add.b   (%a1), %d1
0005ec D2FC 0001       368     adda.w  #1, %a1
                       369 
                       370     /* see if the current position is the end of the expression */
0005f0 B3CA            371     cmp.l   %a2, %a1
0005f2 6700 0006       372     beq     token_div_4_end
0005f6 6000 FFDA       373     bra     token_div_3_operand_2	
                       374 
                       375 /* Store data */
                       376 token_div_4_end:
                       377     /* store operands and operator in global variables */
0005fa 23C0 0000       378 	move.l	%d0, ope1
       0000            378 
000600 23C1 0000       379 	move.l	%d1, ope3
       0000            379 
000606 23C2 0000       380 	move.l	%d2, ope2
       0000            380 
00060c 4CDF 0607       381 	movem.l (%sp)+, %a1-%a2/%d0-%d2
000610 4E75            382 	rts
                       383 
                       384 
                       385 /* CALCULATE AND STORE RESULT */
                       386 ** Do the calculation according to the operator
                       387 ** Store the result in %d3 and global variable ans
                       388 calc:
000612 48E7 F000       389     movem.l %d0-%d3, -(%sp)         /* START: save registers */
000616 2039 0000       390     move.l  ope1, %d0
       0000            390 
00061c 2239 0000       391     move.l  ope3, %d1
       0000            391 
000622 2439 0000       392     move.l  ope2, %d2
       0000            392 
000628 7600            393     move.l  #0, %d3
                       394 
                       395 calc_1_plus:
00062a 0C02 002B       396     cmpi.b   #'+', %d2
00062e 6600 0010       397     bne     calc_2_minus
000632 2600            398     move.l  %d0, %d3
000634 D681            399     add.l   %d1, %d3
000636 23C3 0000       400     move.l  %d3, ans
       0000            400 
00063c 6000 003E       401     bra     calc_5_end
                       402 
                       403 calc_2_minus:
000640 0C02 002D       404     cmpi.b  #'-', %d2
000644 6600 0010       405     bne     calc_3_mul
000648 2600            406     move.l  %d0, %d3
00064a 9681            407     sub.l   %d1, %d3
00064c 23C3 0000       408     move.l  %d3, ans
       0000            408 
000652 6000 0028       409     bra     calc_5_end
                       410 
                       411 calc_3_mul:
000656 0C02 002A       412     cmpi.b  #'*', %d2
00065a 6600 0010       413     bne     calc_4_div
00065e 2600            414     move.l  %d0, %d3
000660 C6C1            415     mulu    %d1, %d3
000662 23C3 0000       416     move.l  %d3, ans
       0000            416 
000668 6000 0012       417     bra     calc_5_end
                       418 
                       419 calc_4_div:
00066c 2600            420     move.l  %d0, %d3          
00066e 86C1            421     divu.w  %d1, %d3                /* Upper word: remainder, lower word: quotient */
000670 0283 0000       422     andi.l  #0x0000ffff, %d3        /* Store only quotient by logical proc */
       FFFF            422 
000676 23C3 0000       423     move.l  %d3, ans
       0000            423 
                       424 
                       425 calc_5_end:
00067c 4CDF 000F       426     movem.l (%sp)+, %d0-%d3         /* END: restore registers */
000680 4E75            427     rts
                       428 
                       429 
                       430 /* CONVERT AND DISPLAY DATA */
                       431 ** Convert the result into decimal following the ASCII code
                       432 ** Display the result using PUTSTRING
                       433 print:
000682 48E7 FC40       434     movem.l %a1/%d0-%d5, -(%sp)     /* START OF PRINT: save registers */
000686 43F9 0000       435     lea.l   ans_print, %a1          /* print buffer */
       0000            435 
00068c 2039 0000       436     move.l  ans, %d0                /* recover result */
       0000            436 
000692 323C 0000       437     move.w  #0, %d1                 /* calc: store temp data */
000696 343C 0000       438     move.w  #0, %d2                 /* calc: count digit */
                       439 
                       440 print_1_calc:
                       441     /* push answer into stack */
00069a 80FC 000A       442     divu.w  #10, %d0
00069e 2200            443     move.l  %d0, %d1                /* copy ans for later use */
0006a0 0280 0000       444     andi.l   #0x0000ffff, %d0       /* to store only quotient (1/2) */
       FFFF            444 
0006a6 4841            445     swap    %d1                     /* to store only quotient (2/2) */
0006a8 1F01            446     move.b  %d1, -(%sp)             /* push digits, starting from the first place of the number */
                       447 
                       448     /* count digit */
0006aa 5242            449     add.w   #1, %d2
0006ac 0C40 0000       450     cmp.w   #0, %d0                 /* see if ans is fully stored */
0006b0 6600 FFE8       451     bne     print_1_calc
0006b4 3A02            452     move.w  %d2, %d5                /* copy digit count for later */
                       453 
                       454 print_2_loop:
                       455     /* pop answer from stack */
0006b6 0C42 0000       456     cmp.w   #0, %d2                 /* see if ans is fully pulled */    
0006ba 6700 000E       457     beq     print_3_end
0006be 129F            458     move.b  (%sp)+, (%a1)           /* pop digits, starting from the last place of the number */
0006c0 0619 0030       459     add.b   #'0', (%a1)+            /* convert to ASCII code */
0006c4 5342            460     sub.w   #1, %d2                 /* count digit */
0006c6 6000 FFEE       461     bra     print_2_loop
                       462 
                       463 print_3_end:
                       464     /* display answer */
0006ca 7002            465     move.l  #SYSCALL_NUM_PUTSTRING, %d0
0006cc 7200            466     move.l  #0, %d1                 /* init %d1 for later */
0006ce 2605            467     move.l  %d5, %d3                /* store no. of digits for later */
0006d0 243C 0000       468     move.l  #ans_print, %d2         /* display buffer */
       0000            468 
0006d6 4E40            469     trap    #0                      /* syscall */
0006d8 4CDF 023F       470     movem.l (%sp)+, %a1/%d0-%d5     /* END OF PRINT: restore registers */
0006dc 4E75            471     rts
                       472 
                       473 /* STEP 0-1: ã‚­ãƒ¥ãƒ¼ã®åˆæœŸåŒ–ãƒ«ãƒ¼ãƒãƒ³ */
                       474 ** (2) é€ä¿¡ã‚­ãƒ¥ãƒ¼ãƒ»å—ä¿¡ã‚­ãƒ¥ãƒ¼ã®ä¸¡æ–¹ã«ã¤ã„ã¦ï¼Œã‚­ãƒ¥ãƒ¼ã®ãƒ‡ãƒ¼ã‚¿ç”¨ãŠã‚ˆã³å‰
                       475 INIT_Q:	
0006de 48E7 00C0       476 	movem.l %a0-%a1 ,-(%sp)
                       477 
                       478     /* ã‚­ãƒ¥ãƒ¼0ã®åˆæœŸåŒ– */
0006e2 207C 0000       479 	movea.l	#Que0, %a0		/*æ§‹é€ ä½“Que0ã®å…ˆé ­ã‚¢ãƒ‰ãƒ¬ã‚¹*/
       0000            479 
0006e8 227C 0000       480 	move.l  #top, %a1	
       000A            480 
0006ee D3C8            481 	add.l	%a0, %a1 		/*a1ã§ã‚­ãƒ¥ãƒ¼ï¼ã®å…ˆé ­ç•ªåœ°ã‚’æŒ‡å®š*/
0006f0 2149 0000       482 	move.l  %a1, out(%a0) 	/*enqueãƒã‚¤ãƒ³ã‚¿åˆæœŸåŒ–*/
0006f4 2149 0004       483 	move.l  %a1, in(%a0) 	/*dequeãƒã‚¤ãƒ³ã‚¿åˆæœŸåŒ–*/
0006f8 117C 0000       484 	move.b	#0, s(%a0) 		/*ã‚«ã‚¦ãƒ³ã‚¿ã®åˆæœŸåŒ–*/
       0008            484 
                       485 
                       486     /* ã‚­ãƒ¥ãƒ¼1ã®åˆæœŸåŒ– */
0006fe 207C 0000       487 	movea.l #Que1, %a0 		/*æ§‹é€ ä½“Queï¼‘ã®å…ˆé ­ã‚¢ãƒ‰ãƒ¬ã‚¹*/
       0000            487 
000704 227C 0000       488 	move.l  #top, %a1
       000A            488 
00070a D3C8            489 	add.l   %a0, %a1 		/*a1ã§ã‚­ãƒ¥ãƒ¼1ã®å…ˆé ­ç•ªåœ°ã‚’æŒ‡å®š*/
00070c 2149 0000       490 	move.l  %a1, out(%a0) 	/*enqueãƒã‚¤ãƒ³ã‚¿åˆæœŸåŒ–*/
000710 2149 0004       491 	move.l  %a1, in(%a0) 	/*dequeãƒã‚¤ãƒ³ã‚¿åˆæœŸåŒ–*/
000714 117C 0000       492 	move.b  #0, s(%a0) 		/*ã‚«ã‚¦ãƒ³ã‚¿ã®åˆæœŸåŒ–*/	
       0008            492 
                       493 
00071a 4CDF 0300       494 	movem.l (%sp)+, %a0-%a1
00071e 4E75            495 	rts
                       496 
                       497 
                       498 /* STEP 0-2: ã‚­ãƒ¥ãƒ¼ã¸ã®å…¥åŠ›(INQ), å‡ºåŠ›(OUTQ) ãƒ«ãƒ¼ãƒãƒ³ã®ä½œæˆ */
                       499 ** INQ(no, data)
                       500 ** argument:    (1) cue number no = %d0
                       501 **              (2) 8-bit data to write = %d1
                       502 ** return:      result flag = %d0 (0: failure, 1: success)
                       503 
                       504 /* (1) */
                       505 INQ:						/* ã‚­ãƒ¥ãƒ¼ã¸ã®å…¥åŠ› */
000720 40E7            506 	move.w	%sr, -(%sp)		/* (1) ç¾èµ°è¡Œãƒ¬ãƒ™ãƒ«ã®é€€é¿ */
000722 46FC 2700       507 	move.w	#0x2700, %sr	/* (2) å‰²ã‚Šè¾¼ã¿ç¦æ­¢ */
000726 48E7 00F0       508 	movem.l	%a0-%a3, -(%sp)	/* ãƒ¬ã‚¸ã‚¹ã‚¿ã®é€€é¿ */
00072a 207C 0000       509 	movea.l	#Que0, %a0		/* ã‚­ãƒ¥ãƒ¼0å‚ç…§ç”¨ã‚¢ãƒ‰ãƒ¬ã‚¹ */
       0000            509 
000730 0C80 0000       510 	cmpi.l	#0, %d0	        /* ã‚­ãƒ¥ãƒ¼ç•ªå·ã®ç¢ºèª */
       0000            510 
000736 6700 0008       511 	beq	INQ_CHECK       	/*ã‚­ãƒ¥ãƒ¼1ã‚’ä½¿ç”¨*/
00073a 207C 0000       512 	movea.l	#Que1, %a0		/* ã‚­ãƒ¥ãƒ¼1å‚ç…§ç”¨ã‚¢ãƒ‰ãƒ¬ã‚¹ */
       0000            512 
                       513 /* (3) */
                       514 INQ_CHECK:
000740 0C68 0100       515 	cmpi.w	#256 ,s(%a0)	/* s == 256 ?ï¼šã‚­ãƒ¥ãƒ¼å†…ã®ãƒ‡ãƒ¼ã‚¿ã®å€‹æ•°ã‚’ç¢ºèª */
       0008            515 
000746 6600 0008       516 	bne	INQ_START			/* true:  ã‚­ãƒ¥ãƒ¼ãŒä¸€æ¯ã§ãªã‘ã‚Œã°æ›¸ãè¾¼ã¿å¯èƒ½ */
00074a 7000            517 	moveq.l	#0, %d0			/* false: (3-1) %D0 ã‚’0ï¼ˆå¤±æ•—ï¼šqueue fullï¼‰ã«è¨­å®šï¼šæ›¸ãè¾¼ã¿å¤±æ•— 
00074c 6000 0038       518 	bra	INQ_END             /* false: (3-2) (7)ã¸ */
                       519 /* (4), (5-2) */
                       520 INQ_START:
                       521     /* (4) m[in] = data */
000750 2268 0004       522 	movea.l	in(%a0), %a1	/* æ›¸ãè¾¼ã¿å…ˆã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æ ¼ç´ */
000754 1281            523 	move.b	%d1, (%a1)		/* æ›¸ãè¾¼ã¿å‡¦ç† */
000756 2448            524 	movea.l	%a0, %a2
000758 D5FC 0000       525 	adda.l	#bottom, %a2	/* ã‚­ãƒ¥ãƒ¼ã®æœ«å°¾ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æ ¼ç´ */
       010A            525 
                       526 
                       527     /* (5) if (in == bottom) */
00075e B5E8 0004       528 	cmpa.l	in(%a0), %a2	/* æ›¸ãè¾¼ã‚“ã ä½ç½®ãŒã‚­ãƒ¥ãƒ¼ã®æœ«å°¾ã‹ç¢ºèª */
000762 6700 000E       529 	beq	INQ_TOP
                       530 
                       531 	/* (5-2) else in++  */
000766 06A8 0000       532 	addi.l	#1, in(%a0)		/* æ›¸ãè¾¼ã¿ä½ç½®ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’1åŠ ç®— */
       0001 0004       532 
00076e 6000 000E       533 	bra	INQ_SUCCESS
                       534 
                       535 /* (5-1) */
                       536 INQ_TOP:
                       537     /*  (5-1) in=top */
000772 267C 0000       538 	move.l	#top, %a3
       000A            538 
000778 D7C8            539 	add.l	%a0, %a3		/* topã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æ±‚ã‚ã‚‹ */
00077a 214B 0004       540 	move.l	%a3, in(%a0)	/* æ›¸ãè¾¼ã¿ä½ç½®ã‚’ã‚­ãƒ¥ãƒ¼ã®å…ˆé ­ã«ç§»å‹• */
                       541 /* (6) */
                       542 INQ_SUCCESS:
                       543     /* s++, %D0 ã‚’1ï¼ˆæˆåŠŸï¼‰ã«è¨­å®š */
00077e 0668 0001       544 	addi.w	#1, s(%a0)		/* å€‹æ•°ã‚’1åŠ ç®— */
       0008            544 
000784 7001            545 	moveq.l	#1, %d0			/* æ›¸ãè¾¼ã¿æˆåŠŸ */
                       546 
                       547 /* (7) */
                       548 INQ_END:	
000786 4CDF 0F00       549 	movem.l	(%sp)+, %a0-%a3	/* ãƒ¬ã‚¸ã‚¹ã‚¿ã®å›å¾© */
00078a 46DF            550 	move.w	(%sp)+, %sr		/* (7) æ—§èµ°è¡Œãƒ¬ãƒ™ãƒ«ã®å›å¾© */
00078c 4E75            551 	rts
                       552 
                       553 **************************************************
                       554 ***a0:é¸æŠã•ã‚ŒãŸæ§‹é€ ä½“ã®å…ˆé ­ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆå¤‰æ›´ä¸å¯ï¼‰
                       555 ***a1:æ§‹é€ ä½“ã®å…ˆé ­ã‚¢ãƒ‰ãƒ¬ã‚¹ã®ã‚³ãƒ”ãƒ¼ï¼ˆå¤‰æ›´å¯
                       556 ***************************************************
                       557 
                       558 ** OUTQ(no, data)
                       559 ** argument:    cue number no = %d0
                       560 ** return:      (1) result flag = %d0 (0: failure, 1: success)
                       561 **              (2) 8-bit data to read = %d1
                       562 
                       563 /* (1), (2) */	
                       564 OUTQ:
00078e 40E7            565 	move.w	%sr, -(%sp) 	/* (1) ç¾èµ°è¡Œãƒ¬ãƒ™ãƒ«ã®é€€é¿ */
000790 46FC 2700       566 	move.w	#0x2700, %sr 	/* (2) å‰²ã‚Šè¾¼ã¿ç¦æ­¢ */
000794 48E7 00F0       567 	movem.l %a0-%a3, -(%sp) /* ãƒ¬ã‚¸ã‚¹ã‚¿é€€é¿ */
000798 207C 0000       568 	movea.l #Que0, %a0		/* ã‚­ãƒ¥ãƒ¼0å‚ç…§ç”¨ã‚¢ãƒ‰ãƒ¬ã‚¹ */
       0000            568 
                       569 
                       570     /* Que0 or Que1 */
00079e 0C80 0000       571 	cmpi.l	#0, %d0	        /* ã‚­ãƒ¥ãƒ¼ç•ªå·ã®ç¢ºèª */
       0000            571 
0007a4 6700 0008       572 	beq	OUTQ_CHECK      	/* ã‚­ãƒ¥ãƒ¼0ã‚’ä½¿ç”¨ */
                       573 	              			/* ã‚­ãƒ¥ãƒ¼1ã‚’ä½¿ç”¨ */
0007a8 207C 0000       574 	movea.l #Que1, %a0		/* ã‚­ãƒ¥ãƒ¼1å‚ç…§ç”¨ã‚¢ãƒ‰ãƒ¬ã‚¹ */
       0000            574 
                       575 /* (3) */	
                       576 OUTQ_CHECK:
                       577     /* (3) s == 0 ãªã‚‰ã°%D0 ã‚’0ï¼ˆå¤±æ•—ï¼šqueue emptyï¼‰ã«è¨­å®šã—ï¼Œ(7) ã¸ */
0007ae 0C68 0000       578 	cmpi.w	#0, s(%a0)      /* ã‚­ãƒ¥ãƒ¼å†…ã®ãƒ‡ãƒ¼ã‚¿ã®å€‹æ•°ã‚’ç¢ºèª */
       0008            578 
0007b4 6600 0008       579 	bne	OUTQ_START      	/* ã‚­ãƒ¥ãƒ¼ãŒä¸€æ¯ã§ãªã‘ã‚Œã°èª­ã¿å‡ºã—å¯èƒ½ */
0007b8 7000            580 	moveq.l	 #0, %d0 		/*å¤±æ•—*/
0007ba 6000 0038       581 	bra	OUTQ_END
                       582 /* (4), (5-2) */
                       583 OUTQ_START:
0007be 2268 0000       584 	movea.l out(%a0), %a1   /* èª­ã¿å‡ºã—å…ˆã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æ ¼ç´*/
0007c2 1211            585 	move.b  (%a1), %d1      /* (4) data = m[out]ï¼›èª­ã¿å‡ºã—å‡¦ç†*/
0007c4 2448            586 	movea.l	%a0, %a2
0007c6 D5FC 0000       587 	adda.l	#bottom, %a2	/* ã‚­ãƒ¥ãƒ¼ã®æœ«å°¾ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æ ¼ç´ */
       010A            587 
                       588 
                       589     /* (5) if (out == bottom) */
0007cc B5E8 0000       590 	cmpa.l	out(%a0), %a2	/* èª­ã¿è¾¼ã‚“ã ä½ç½®ãŒã‚­ãƒ¥ãƒ¼ã®æœ«å°¾ã‹ç¢ºèª */
0007d0 6700 000E       591 	beq	OUTQ_TOP
                       592 
                       593 	/* (5-2) else out++  */
0007d4 06A8 0000       594 	addi.l	#1, out(%a0)	/* èª­ã¿å‡ºã—ä½ç½®ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’1åŠ ç®— */
       0001 0000       594 
0007dc 6000 000E       595 	bra OUTQ_SUCCESS
                       596 
                       597 /* (5-1) */
                       598 OUTQ_TOP:
                       599     /*  (5-1) out=top */
0007e0 267C 0000       600 	move.l	#top, %a3
       000A            600 
0007e6 D7C8            601 	add.l	%a0, %a3		/* topã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æ±‚ã‚ã‚‹ */
0007e8 214B 0000       602 	move.l	%a3, out(%a0)	/* èª­ã¿å‡ºã—ä½ç½®ã‚’ã‚­ãƒ¥ãƒ¼ã®å…ˆé ­ã«ç§»å‹• */
                       603 
                       604 /* (6) */
                       605 OUTQ_SUCCESS:
                       606     /* sâ€“â€“, %D0 ã‚’1ï¼ˆæˆåŠŸï¼‰ã«è¨­å®š */
0007ec 0468 0001       607 	subi.w	#1, s(%a0)		/* å€‹æ•°ã‚’1æ¸›ç®— */
       0008            607 
0007f2 7001            608 	moveq.l	#1, %d0			/* èª­ã¿å‡ºã—æˆåŠŸ */
                       609 
                       610 /* (7)  */
                       611 OUTQ_END:	
0007f4 4CDF 0F00       612 	movem.l	(%sp)+, %a0-%a3	/* ãƒ¬ã‚¸ã‚¹ã‚¿ã®å›å¾© */
0007f8 46DF            613 	move.w	(%sp)+, %sr		/* (7) æ—§èµ°è¡Œãƒ¬ãƒ™ãƒ«ã®å›å¾© */
0007fa 4E75            614 	rts
                       615 
                       616 
                       617 **************************************************
                       618 ***a0:é¸æŠã•ã‚ŒãŸæ§‹é€ ä½“ã®å…ˆé ­ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆå¤‰æ›´ä¸å¯ï¼‰
                       619 ***a1:æ§‹é€ ä½“ã®å…ˆé ­ã‚¢ãƒ‰ãƒ¬ã‚¹ã®ã‚³ãƒ”ãƒ¼ï¼ˆå¤‰æ›´å¯ï¼‰
                       620 ***************************************************
                       621 
                       622 **ã“ã“ã‹ã‚‰INTERPUTãƒ»PUTSTRING
                       623 **æ‹…å½“ï¼šè«¸éšˆãƒ»å®®ç”°ãƒ»ç€¬å°¾
                       624 
                       625 INTERPUT:
                       626     **(1) å‰²ã‚Šè¾¼ã¿ç¦æ­¢ï¼ˆèµ°è¡Œãƒ¬ãƒ™ãƒ«ã‚’7ã«è¨­å®šï¼‰
0007fc 46FC 2700       627     move.w  #0x2700, %SR
000800 48E7 8000       628     movem.l %d0, -(%sp)
                       629 	
                       630     **(2) ch â‰  0 ãªã‚‰ã°ã€ä½•ã‚‚ã›ãšã«å¾©å¸°
000804 0C81 0000       631     cmp.l   #0, %d1
       0000            631 
00080a 6600 001C       632     bne     INTERPUT_Exit
                       633 
                       634     **(3) OUTQ(1, data) ã‚’å®Ÿè¡Œã™ã‚‹ (= é€ä¿¡ã‚­ãƒ¥ãƒ¼ã‹ã‚‰8bitãƒ‡ãƒ¼ã‚¿ã‚’1ã¤å–ã‚Šå‡ºã—dat
00080e 7001            635     move.l  #1, %d0     | ã‚­ãƒ¥ãƒ¼ç•ªå·ã‚’æŒ‡å®š (1ã¯é€ä¿¡ã‚­ãƒ¥ãƒ¼)
000810 4EBA FF7C       636     jsr     OUTQ
                       637 
                       638     **(4) OUTQã®æˆ»ã‚Šå€¤ãŒ0 (å¤±æ•—) ãªã‚‰ã°ã€é€ä¿¡å‰²ã‚Šè¾¼ã¿ã‚’ãƒã‚¹ã‚¯ (USTCNT1ã‚’æ“ä½
000814 0C80 0000       639     cmp.l  #0, %d0           | %D0ã«OUTQã®æˆ»ã‚Šå€¤ãŒæ ¼ç´ã•ã‚Œã¦ã„ã‚‹
       0000            639 
00081a 6700 0012       640     beq     INTERPUT_MUSK | OUTQãŒå¤±æ•—ã—ãŸå ´åˆã¯ä½•ã‚‚é€ä¿¡ã›ãšã«å¾©å¸°
                       641 
                       642     **(5) dataã‚’é€ä¿¡ãƒ¬ã‚¸ã‚¹ã‚¿UTX1ã«ä»£å…¥ã—ã¦é€ä¿¡ (ä¸Šä½8ãƒ“ãƒƒãƒˆåˆ†ã®ãƒ˜ãƒƒãƒ€ã‚’å¿˜
                       643     **ä¸Šä½8ãƒ“ãƒƒãƒˆã®ãƒ˜ãƒƒãƒ€ã‚’ä»˜ä¸ã—ã¦ãŠã
00081e 0641 0800       644     add.w  #0x0800, %d1
000822 33C1 00FF       645     move.w  %d1, UTX1
       F906            645 
                       646     
                       647 INTERPUT_Exit:
                       648     **(6) æ—§èµ°è¡Œãƒ¬ãƒ™ãƒ«ã®å›å¾©
000828 4CDF 0001       649     movem.l (%sp)+, %d0
00082c 4E75            650     rts
                       651 
                       652 INTERPUT_MUSK:
00082e 33FC E108       653     move.w #0xE108, USTCNT1
       00FF F900       653 
000836 6000 FFF0       654     bra INTERPUT_Exit
                       655 
                       656 /* STEP 5: é€ä¿¡åˆ¶å¾¡éƒ¨ã®å®Œæˆï¼ˆPUTSTRINGï¼‰*/
                       657 
                       658 *****************************************
                       659 *** a0=i
                       660 *** d0=sz(å®Ÿéš›ã«é€ä¿¡ã—ãŸãƒ‡ãƒ¼ã‚¿æ•°)
                       661 *** d1=ch
                       662 *** d2=p(ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿å…ˆã®å…ˆé ­ã‚¢ãƒ‰ãƒ¬ã‚¹)
                       663 *** d3=size(é€ä¿¡ã™ã‚‹ãƒ‡ãƒ¼ã‚¿æ•°)
                       664 *****************************************
                       665 
                       666 PUTSTRING:
00083a 48E7 00F0       667 	movem.l	%a0-%a3, -(%sp)
00083e 0C81 0000       668 	cmp.l   #0, %d1 /*chãŒ1ã‹ã©ã†ã‹*/
       0000            668 
000844 6600 004C       669        	bne     FINISH_PUTSTRING
                       670 	
                       671 	/*sz, iã®åˆæœŸåŒ–*/
000848 41F9 0000       672 	lea.l	sz, %a0 /*%a0 : sz address*/
       0000            672 
00084e 43F9 0000       673 	lea.l	i, %a1 /*%a1 : i address*/
       0000            673 
000854 20BC 0000       674  	move.l	#0, (%a0)
       0000            674 
00085a 2282            675 	move.l	%d2, (%a1)
                       676 
00085c 0C83 0000       677 	cmp.l	#0, %d3
       0000            677 
000862 6700 002C       678 	beq	RETURN_PUTSTR
                       679 
                       680 loop_PUTSTR:
000866 B690            681 	cmp.l	(%a0), %d3
000868 6700 001E       682 	beq	SET_TXEE_PUTSTR
                       683 	
00086c 7001            684 	move.l	#1, %d0
00086e 2651            685 	movea.l	(%a1), %a3
000870 1213            686 	move.b	(%a3), %d1 /*å¼•æ•°:data*/
000872 4EBA FEAC       687 	jsr	INQ	/*INQ(1, i)*/
000876 0C80 0000       688 	cmp.l	#0, %d0
       0000            688 
00087c 6700 000A       689 	beq	SET_TXEE_PUTSTR
000880 5290            690 	add.l	#1, (%a0) /* sz++ */
000882 5291            691 	add.l	#1, (%a1) /* i++ */
000884 6000 FFE0       692 	bra	loop_PUTSTR
                       693 	
                       694 
                       695 SET_TXEE_PUTSTR:
000888 33FC E10C       696 	move.w  #0xe10C, USTCNT1 /*é€ä¿¡å‰²ã‚Šè¾¼ã¿ã‚’ã‚¢ãƒ³ãƒã‚¹ã‚¯*/
       00FF F900       696 
                       697 	
                       698 RETURN_PUTSTR:	
000890 2010            699 	move.l	(%a0), %d0	
                       700 
                       701 FINISH_PUTSTRING:
000892 4CDF 0F00       702 	movem.l	(%sp)+, %a0-%a3
000896 4E75            703 	rts
                       704 
                       705 
                       706 /* STEP 6: å—ä¿¡åˆ¶å¾¡éƒ¨ã®å®Œæˆï¼ˆGETSTRING, INTERGETï¼‰*/
                       707 /* STEP 6-1: GETSTRING */
                       708 GETSTRING:
000898 48E7 7880       709     movem.l %d1-%d4/%a0, -(%sp)
                       710 
                       711     ** (1) ch!=0ãªã‚‰ã°ï¼Œãªã«ã‚‚å®Ÿè¡Œã›ãšå¾©å¸°
00089c 0C81 0000       712     cmpi.l #0x0, %d1
       0000            712 
0008a2 6600 002E       713     bne GETSTRING_Exit /* d1 != 0ãªã‚‰ã°ï¼Œèµ°è¡Œãƒ¬ãƒ™ãƒ«ã‚’å›å¾©ã•ã›å‡¦ç†ã‚’çµ‚äº† */
                       714 
                       715     ** (2) sz <- 0, i <- p
0008a6 7800            716     move.l #0, %d4
0008a8 2042            717     movea.l %d2, %a0
                       718 
                       719 GETSTRING_LOOP:
                       720     ** (3) sz = sizeãªã‚‰ã°ï¼Œ(9)ã¸
0008aa B684            721         cmp.l %d4, %d3
0008ac 6700 0024       722         beq GETSTRING_Exit
                       723 
                       724     ** (4) OUTQ(0, data)ã«ã‚ˆã‚Šï¼Œå—ä¿¡ã‚­ãƒ¥ãƒ¼ã‹ã‚‰8bitãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
0008b0 7000            725         move.l #0, %d0
0008b2 4EBA FEDA       726         jsr OUTQ
                       727 
                       728     ** (5) OUTQã®å¾©å¸°å€¤ï¼ˆ%0ã®å€¤ï¼‰ãŒ0ï¼ˆï¼å¤±æ•—ï¼‰ãªã‚‰(9)ã¸
0008b6 0C80 0000       729         cmp.l #0, %d0
       0000            729 
0008bc 6700 0014       730         beq GETSTRING_Exit
                       731 
                       732     ** (6) iç•ªåœ°ã«dataã‚’ã‚³ãƒ”ãƒ¼
0008c0 1081            733         move.b %d1, (%a0)
                       734 
                       735     ** (7) sz++, i++
0008c2 0684 0000       736         addi.l #1, %d4
       0001            736 
0008c8 D1FC 0000       737         adda.l #1, %a0
       0001            737 
                       738 
                       739     ** (8) (3)ã¸
0008ce 6000 FFDA       740         bra GETSTRING_LOOP
                       741 
                       742 GETSTRING_Exit:
                       743     ** (9) sz -> %d0
0008d2 13FC 0038       744         move.b #'8',LED0
       00D0 0039       744 
0008da 2004            745         move.l %d4, %d0
0008dc 4CDF 011E       746         movem.l (%sp)+, %d1-%d4/%a0
0008e0 4E75            747         rts
                       748 
                       749 /* STEP 6-2: INTERGET */
                       750 ***********************************************
                       751 *** INTERGET(ch, data)
                       752 *** ã€æ©Ÿèƒ½ã€‘
                       753 *** - å—ä¿¡ãƒ‡ãƒ¼ã‚¿ã‚’å—ä¿¡ã‚­ãƒ¥ãƒ¼ã«æ ¼ç´ã™ã‚‹
                       754 *** - ãƒãƒ£ãƒãƒ«chãŒ0ä»¥å¤–ã®å ´åˆã¯ï¼Œãªã«ã‚‚å®Ÿè¡Œã—ãªã„
                       755 *** ã€å…¥åŠ›ã€‘
                       756 *** - ãƒãƒ£ãƒãƒ«ï¼šch -> %d1.l
                       757 *** - å—ä¿¡ãƒ‡ãƒ¼ã‚¿ï¼šdata -> %d2.b
                       758 *** ã€æˆ»ã‚Šå€¤ã€‘
                       759 *** ãªã—
                       760 *** ã€å‡¦ç†å†…å®¹ã€‘
                       761 *** (1) ch!=0ãªã‚‰ã°ï¼Œãªã«ã‚‚å®Ÿè¡Œã›ãšå¾©å¸°
                       762 *** (2) INQ(0, data)
                       763 ***********************************************
                       764 
                       765 INTERGET:
0008e2 48E7 E000       766     movem.l %d0-%d2, -(%sp)
                       767 
                       768 * (1) ch!=0ãªã‚‰ã°ï¼Œãªã«ã‚‚å®Ÿè¡Œã›ãšå¾©å¸°
0008e6 0C81 0000       769     cmpi.l #0x0, %d1
       0000            769 
0008ec 6600 001A       770     bne INTERGET_Finish  /* èµ°è¡Œãƒ¬ãƒ™ãƒ«ã‚’å›å¾©ã•ã›å‡¦ç†ã‚’çµ‚äº† */
                       771 
                       772 * (2) INQ(0, data)
0008f0 7000            773     move.l #0, %d0
0008f2 1202            774     move.b %d2, %d1
0008f4 13FC 0031       775     move.b #'1', LED2   /* æ–‡å­—'1'ã‚’LEDã®8æ¡ç›®ã«è¡¨ç¤º */
       00D0 003D       775 
0008fc 4EBA FE22       776     jsr INQ
000900 13FC 0033       777     move.b #'3', LED3   /* æ–‡å­—'3'ã‚’LEDã®6æ¡ç›®ã«è¡¨ç¤º */
       00D0 003F       777 
                       778 
                       779 INTERGET_Finish:
000908 4CDF 0007       780     movem.l (%sp)+, %d0-%d2
00090c 4E75            781     rts
                       782 
                       783 /* STEP 7: ã‚¿ã‚¤ãƒåˆ¶å¾¡éƒ¨ã®å®Œæˆï¼ˆRESET_TIMER, SET_TIMER, CALL_RP, TIMER INTERFACEï¼‰*/
                       784 /* STEP 7-3: TIMER INTERFACE */
                       785 ** ã“ã£ã‹ã‚‰TIMERé–¢ä¿‚
                       786 ** æ‹…å½“ï¼šæ­¦çŸ³
                       787 timer_interface:
00090e 48E7 8000       788     movem.l %d0, -(%sp)         | ãƒ¬ã‚¸ã‚¹ã‚¿é€€é¿
000912 3039 00FF       789     move.w TSTAT1, %d0          | ã¨ã‚Šã‚ãˆãšd0 = TSTAT1 ã«ã‚³ãƒ”ãƒ¼
       F60A            789 
000918 0240 0001       790     andi.w #0x0001, %d0         | d0 = d0 & 0x0001
00091c 6600 0004       791     bne timer_interface_label   | d0 = TSATA1 ã®ç¬¬ 0 ãƒ“ãƒƒãƒˆãŒ 0 ãªã‚‰ã° timer_interface_lab
000920 4E73            792     rte                         | 1 ãªã‚‰ã° rte ã§å¾©å¸°
                       793 
                       794 timer_interface_label:
000922 33FC 0000       795     move.w #0x0000, TSTAT1      | TSTAT1 = 0 (TSTAT1 ã®ãƒªã‚»ãƒƒãƒˆ)
       00FF F60A       795 
00092a 4EBA 0038       796     jsr CALL_RP                 | CALL RP ã‚’å‘¼ã³å‡ºã™
00092e 4CDF 0001       797     movem.l (%sp)+, %d0         | ãƒ¬ã‚¸ã‚¹ã‚¿å›å¾©
000932 4E73            798     rte
                       799 
                       800 /* STEP 7-1: RESET TIMER */
                       801 RESET_TIMER:
000934 33FC 0004       802     move.w #0x0004, TCTL1
       00FF F600       802 
00093c 4E75            803     rts
                       804 
                       805 /* STEP 7-2: SET TIMER */
                       806 SET_TIMER:
00093e 48E7 6000       807     movem.l	%d1-%d2, -(%sp)     | ãƒ¬ã‚¸ã‚¹ã‚¿é€€é¿
000942 23C2 0000       808     move.l %d2, task_p          | å…ˆé ­ã‚¢ãƒ‰ãƒ¬ã‚¹ p â†’ %D2.L ã‚’ï¼Œå¤§åŸŸå¤‰æ•° task p ã«ä»£å…
       0000            808 
000948 33FC 00CE       809     move.w #0x00CE, TPRER1      | TPRER1ã®å€¤ã¯, è¨ˆç®—ã™ã‚‹ã¨ 206.2576 ã«ãªã£ãŸ. æ¨å¥¨å€¤
       00FF F602       809 
000950 33C1 00FF       810     move.w %d1, TCMP1           | ã‚¿ã‚¤ãƒå‰²ã‚Šè¾¼ã¿ç™ºç”Ÿå‘¨æœŸ t ã‚’ï¼Œã‚¿ã‚¤ãƒ 1 ã‚³ãƒ³ãƒšã‚
       F604            810 
000956 33FC 0015       811     move.w #0x0015, TCTL1       | TCTL1 = 0000 0000 0001 0101
       00FF F600       811 
00095e 4CDF 0006       812     movem.l	(%sp)+, %d1-%d2     | ãƒ¬ã‚¸ã‚¹ã‚¿å¾©å¸°
000962 4E75            813     rts
                       814 
                       815 /* STEP 7-3: CALL_RP */
                       816 CALL_RP:
000964 48E7 0080       817     movem.l	%a0, -(%sp)
000968 2079 0000       818 	movea.l task_p, %a0 
       0000            818 
00096e 4E90            819 	jsr (%a0)
000970 4CDF 0100       820 	movem.l (%sp)+, %a0
000974 4E75            821 	rts
                       822 
                       823 
                       824 /* STEP 8: ã‚·ã‚¹ãƒ†ãƒ ã‚³ãƒ¼ãƒ«ã‚¤ãƒ³ã‚¿ãƒ•ã‚§ãƒ¼ã‚¹ã®å®Œæˆ */
                       825 ** ã“ã“ã‹ã‚‰ã‚·ã‚¹ãƒ†ãƒ ã‚³ãƒ¼ãƒ«ã‚¤ãƒ³ã‚¿ãƒ•ã‚§ãƒ¼ã‚¹
                       826 ** æ‹…å½“ï¼šå¾Œè—¤
                       827 
                       828 SYSCALL_INTERFACE:
                       829 ** (1) ã‚·ã‚¹ãƒ†ãƒ ã‚³ãƒ¼ãƒ«ç•ªå· %D0 ã‚’ å®Ÿè¡Œå…ˆã‚¢ãƒ‰ãƒ¬ã‚¹ã«å¤‰æ›ã™ã‚‹ï¼
                       830 ** (2) ã‚·ã‚¹ãƒ†ãƒ ã‚³ãƒ¼ãƒ«ã‚’å‘¼ã³å‡ºã™
                       831 
000976 48E7 0080       832     movem.l %a0, -(%sp) |ãƒ¬ã‚¸ã‚¹ã‚¿é€€é¿
00097a 0C80 0000       833     cmp.l #SYSCALL_NUM_GETSTRING, %d0
       0001            833 
000980 6700 0020       834     beq SYSCALL_1
000984 0C80 0000       835     cmp.l #SYSCALL_NUM_PUTSTRING, %d0
       0002            835 
00098a 6700 0020       836     beq SYSCALL_2
00098e 0C80 0000       837     cmp.l #SYSCALL_NUM_RESET_TIMER, %d0
       0003            837 
000994 6700 0020       838     beq SYSCALL_3
000998 0C80 0000       839     cmp.l #SYSCALL_NUM_SET_TIMER, %d0
       0004            839 
00099e 6700 0020       840     beq SYSCALL_4
                       841 SYSCALL_1:
0009a2 203C 0000       842     move.l #GETSTRING, %d0
       0000            842 
0009a8 6000 0020       843     bra JUMP_SYSCALL
                       844 SYSCALL_2:
0009ac 203C 0000       845     move.l #PUTSTRING, %d0
       0000            845 
0009b2 6000 0016       846     bra JUMP_SYSCALL
                       847 SYSCALL_3:
0009b6 203C 0000       848     move.l #RESET_TIMER, %d0
       0000            848 
0009bc 6000 000C       849     bra JUMP_SYSCALL
                       850 SYSCALL_4:
0009c0 203C 0000       851     move.l #SET_TIMER, %d0
       0000            851 
0009c6 6000 0002       852     bra JUMP_SYSCALL
                       853 JUMP_SYSCALL:
0009ca 2040            854     movea.l %d0, %a0
0009cc 4E90            855     jsr (%a0)
                       856 SYSCALL_INTERFACE_FINISH:
0009ce 4CDF 0100       857     movem.l (%sp)+,%a0  |ãƒ¬ã‚¸ã‚¹ã‚¿å¾©å¸°
0009d2 4E73            858     rte
                       859 
                       860 
                       861 .section .data
                       862 
                       863 /* STEP 0-1: ã‚­ãƒ¥ãƒ¼ã®åˆæœŸåŒ–ãƒ«ãƒ¼ãƒãƒ³ */
                       864 ** (2) ãƒ‡ãƒ¼ã‚¿é ˜åŸŸã®ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆå…ˆé ­ãƒ»æœ«å°¾ï¼‰ã‚’ä»£å…¥ï¼Œãƒ‡ãƒ¼ã‚¿æ•°ã®åˆæœŸåŒ–
0009d6 0000 0000       865 Que_START:	.ds.b	536
       0000 0000       865 
       0000 0000       865 
       0000 0000       865 
       0000 0000       865 
                       866 
                       867 	/*ã‚­ãƒ¥ãƒ¼ã®å„å…ˆé ­ã‚¢ãƒ‰ãƒ¬ã‚¹*/
                       868     .equ    Que0, Que_START
                       869     .equ    Que1, Que0 + 0x0000010c
                       870 	
                       871 	/*ã‚­ãƒ¥ãƒ¼ã®å„è¦ç´ ã®ã‚ªãƒ•ã‚»ãƒƒãƒˆ*/
                       872 	.equ	out, 0
                       873 	.equ	in, 4
                       874 	.equ	s, 8  /*2byteåˆ†ç¢ºä¿*/
                       875 	.equ	top, 10
                       876 	.equ	bottom, 266
                       877 
000bee 0000 0000       878 sz:		.ds.l 1
000bf2 0000 0000       879 i: 		.ds.l 1
                       880 
                       881 
000bf6 0000 0000       882 buf:		.ds.b	256
       0000 0000       882 
       0000 0000       882 
       0000 0000       882 
       0000 0000       882 
000cf6 0000 0000       883 buf_len:	.ds.l	1
000cfa 0000 0000       884 ope1:		.ds.l	1 /*ç¬¬ï¼‘å¼•æ•°*/
000cfe 0000 0000       885 ope2:		.ds.l	1 /*ç¬¬ï¼’å¼•æ•°*/
000d02 0000 0000       886 ope3:		.ds.l	1 /*ç¬¬ï¼“å¼•æ•°*/
000d06 0000 0000       887 ans:		.ds.l	1
000d0a 0000 0000       888 ans_print:      .ds.b   256
       0000 0000       888 
       0000 0000       888 
       0000 0000       888 
       0000 0000       888 
                       889 
                       890 .end
